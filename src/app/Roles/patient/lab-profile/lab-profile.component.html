<!-- Breadcrumb -->
<div class="breadcrumb-bar">
	<div class="container-fluid">
		<div class="row align-items-center">
			<div class="col-md-12 col-12">
				<nav aria-label="breadcrumb" class="page-breadcrumb">
					<ol class="breadcrumb">
						<li class="breadcrumb-item"><a href="index-2.html">Home</a></li>
						<li class="breadcrumb-item active" aria-current="page">Lab Profile</li>
					</ol>
				</nav>
				<h2 class="breadcrumb-title">Doctor Profile</h2>
			</div>
		</div>
	</div>
</div>
<!-- /Breadcrumb -->

<!-- Page Content -->
<div class="content">
	<div class="container">

		<!-- Doctor Widget -->
		<div class="card">
			<div class="card-body">
				<div class="doctor-widget">

					<div class="doc-info-left">
						<div class="doctor-img">
							<a href="#" class="booking-doc-img">
								<div>
									<figure><img alt="jobBox" [src]= lab.imageName height="150px"
											width="100px"></figure>
								</div>
							</a>

						</div>
						<div class="doc-info-cont">
							<h3 class="doc-name">{{ lab.labName }}</h3>
							<h3 class="bi bi-envelope-open">&nbsp;{{ lab.email }}</h3>
							<h3 class="bi bi-file-earmark-text-fill">&nbsp;{{lab.biography}}</h3>

						    <div class="review-count rating">
								<i [class]="star" *ngFor="let star of getStarIcons(lab.rating)"></i>
							</div>
							<div class="clinic-details" *ngIf="lab.location">
								<p class="doc-location"><i class="fas fa-map-marker-alt"></i>
									{{lab.location.area}}{{lab.location.addressLine}}</p>
							</div>
						</div>
					</div>
					<div class="doc-info-right">
						<div class="clini-infos">
							<ul>
								<li>
									<i class="far fa-thumbs-up"></i>
									{{ lab.isApproved ? 'Approved' : 'Not Approved' }}
								</li>

								<li><i class="fas fa-phone"></i> {{ lab.phone }}</li>
							</ul>
						</div>
						<div class="clinic-booking">
							<a class="apt-btn" (click)="makeLabFavorite(lab.id)">Make Lab Favorite</a>

							<div *ngIf="labButtonClicked[lab.id]">

							</div>
							<a class="apt-btn" [routerLink]="'/labTestList/'+lab.id">View
								LabTest</a>

						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- /Doctor Widget -->

		<!-- Doctor Details Tab -->
		<div class="card">
			<div class="card-body pt-0">

				<!-- Tab Menu -->
				<nav class="user-tabs mb-4">
					<ul class="nav nav-tabs nav-tabs-bottom nav-justified">
						<li class="nav-item">
							<a class="nav-link active" href="#doc_overview" data-toggle="tab">Overview</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="#doc_locations" data-toggle="tab">Locations</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="#doc_reviews" data-toggle="tab">Reviews</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="#doc_business_hours" data-toggle="tab">Business Hours</a>
						</li>
					</ul>
				</nav>
				<!-- /Tab Menu -->

				<!-- Tab Content -->
				<div class="tab-content pt-0">

					<!-- Overview Content -->
					<div role="tabpanel" id="doc_overview" class="tab-pane fade show active">
						<div class="row">
							<div class="col-md-12 col-lg-9">
								<!-- Lab Overview -->
								<div class="widget about-widget">
									<h4 class="widget-title">Lab Overview</h4>
									<p><strong>Lab Name:</strong> {{ lab.labName }}</p>
									<p><strong>Email:</strong> {{ lab.email }}</p>
									<p><strong>Phone:</strong> {{ lab.phone }}</p>
									<p><strong>Location:</strong> {{ lab.location.area }}, {{ lab.location.city }}, {{
										lab.location.country }}</p>
									<p><strong>Biography:</strong> {{ lab.biography }}</p>
									<!-- <p><strong>Rating:</strong> {{ lab.labReviewRatings[0].rating }}</p> -->
									<!-- Display reviews if needed -->
								</div>
								<!-- /Lab Overview -->
							</div>
						</div>
					</div>

					<!-- /Overview Content -->

					<!-- Locations Content -->
					<div role="tabpanel" id="doc_locations" class="tab-pane fade">



						<!-- Location List -->
						<div class="location-list">
							<div class="row">
								<!-- Lab Content -->
								<div class="col-md-6">
									<div class="clinic-content">
										<h4 class="clinic-name"><a href="#">{{ lab.labName }}</a></h4>
										<p class="doc-speciality">Specialization: Pathology MD</p>
										<!-- Add lab rating -->
										<div class="rating">
											<i class="fas fa-star filled"></i>
											<i class="fas fa-star filled"></i>
											<i class="fas fa-star filled"></i>
											<i class="fas fa-star filled"></i>
											<i class="fas fa-star"></i>
											<span class="d-inline-block average-rating">(9)</span>
										</div>
										<div class="clinic-details mb-0">
											<p class="clinic-direction"><i class="fas fa-map-marker-alt"></i> {{
												lab.location.area }}, {{ lab.location.city }}, {{ lab.location.country
												}}, {{ lab.location.pinCode }}</p>
											<ul>
												<li>
													<div class="doctor-img">
														<a href="#" class="booking-doc-img">
															<div>
																<figure><img alt="jobBox"
																		[src]="IMG_URLs + lab.imageName" height="150px"
																		width="100px"></figure>
															</div>
														</a>

													</div>
												</li>
											</ul>
										</div>
									</div>
								</div>
								<!-- /Lab Content -->

								<!-- Lab Timing (Assuming static timing for demonstration) -->
								<div class="col-md-4">
									<div class="clinic-timing">
										<div>
											<p class="timings-days">
												<span>Mon - Fri</span>
											</p>
											<p class="timings-times">
												<span>9:00 AM - 5:00 PM</span>
											</p>
										</div>
										<div>
											<p class="timings-days">
												<span>Sat - Sun</span>
											</p>
											<p class="timings-times">
												<span>Closed</span>
											</p>
										</div>
									</div>
								</div>
								<!-- /Lab Timing -->

								<!-- Consultation Price -->
								<div class="col-md-2">
									<div class="consult-price">
										$350
									</div>
								</div>
								<!-- /Consultation Price -->
							</div>
						</div>

						<!-- /Location List -->

					</div>
					<!-- /Locations Content -->




					<!-- review start -->
					<div role="tabpanel" id="doc_reviews" class="tab-pane fade">
						<div class="widget review-listing">
							<ul class="comments-list">
								<li *ngFor="let review of labReviews">
									<div class="comment">
										<img class="avatar avatar-sm rounded-circle" [src]="review.imageName"
											alt="User Image">
										<div class="comment-body">
											<div class="meta-data">
												<span class="comment-author">{{ review.patientName }}</span>
											</div>
											<div class="review-count rating">
												<i [class]="star" *ngFor="let star of getStarIcons(review.rating)"></i>
											</div>
											<p class="comment-content">{{ review.description }}</p>
											<div class="buttons-row d-flex align-items-center">
												<a class="comment-btn reply-btn" (click)="review.showReplyForm = !review.showReplyForm">
												  <i class="fas fa-reply"></i> Reply
												</a>
												<!-- Delete button (shown only for the logged-in patient's reviews) -->
												<div *ngIf="review.patientId === loggedInPatientId" class="delete-btn">
												  <i class="bi bi-trash" (click)="deleteReview(review.id)"></i>
												</div>

												<div *ngIf="review.showReplyForm">
													<textarea class="form-control" [(ngModel)]="review.replyContent"
														placeholder="Write a reply..."></textarea>
													<button class="btn btn-primary"
														(click)="submitReply(review)">Submit</button>
												</div>
											</div>
										</div>
									</div>
									<ul class="comments-reply">
										<li *ngFor="let reply of review.replyResponse">
											<div class="comment">
												<img class="avatar avatar-sm rounded-circle"
													[src]="reply.imageName" alt="User Image">
												<div class="comment-body">
													<div class="meta-data">
														<span class="comment-author">{{ reply.patientName }}</span>
													</div>

													

													<div  class="delete-btn">
														<p class="comment-content">{{ reply.description }}</p>
														<i class="bi bi-trash" *ngIf="review.patientId === loggedInPatientId || reply.patientId === loggedInPatientId" (click)="deleteReply( reply.id,review.id)"></i>
													  </div>
												</div>
											</div>
										</li>
									</ul>
								</li>
							</ul>
							<div class="write-review" *ngIf="isLoggedIn">
								<h4>Write a review for <strong>{{ lab.labName }}</strong></h4>
								<form (ngSubmit)="submitReview()">
									<div class="form-group">
										<label>Review</label>
										<app-star-rating [currentRating]="selectedRating"
											(ratingClicked)="selectedRating = $event"></app-star-rating>
									</div>
									<div class="form-group">
										<label>Your review</label>
										<textarea id="review_desc" maxlength="100" class="form-control"
											[(ngModel)]="description" name="description" required></textarea>
										<div class="d-flex justify-content-between mt-3">
											<small class="text-muted"><span id="chars">{{ remainingCharacters }}</span>
												characters remaining</small>
										</div>
									</div>
									<hr>
									<div class="form-group">
										<div class="terms-accept">
											<div class="custom-checkbox">
												<input type="checkbox" id="terms_accept" [(ngModel)]="termsAccepted"
													name="terms_accept" required>
												<label for="terms_accept">I have read and accept <a href="#">Terms &amp;
														Conditions</a></label>
											</div>
										</div>
									</div>
									<div class="submit-section">
										<button type="submit" class="btn btn-primary submit-btn"
											[disabled]="!termsAccepted">Add Review</button>
									</div>
								</form>
							</div>
						</div>
					</div>




					<!-- /Reviews Content -->

					<!-- Business Hours Content -->
					<div role="tabpanel" id="doc_business_hours" class="tab-pane fade">
						<div class="row">
							<div class="col-md-6 offset-md-3">

								<!-- Business Hours Widget -->
								<div class="widget business-widget">
									<div class="widget-content">
										<div class="listing-hours">
											<div class="listing-day current">
												<div class="day">Today <span>5 Nov 2019</span></div>
												<div class="time-items">
													<span class="open-status"><span class="badge bg-success-light">Open
															Now</span></span>
													<span class="time">07:00 AM - 09:00 PM</span>
												</div>
											</div>
											<div class="listing-day">
												<div class="day">Monday</div>
												<div class="time-items">
													<span class="time">07:00 AM - 09:00 PM</span>
												</div>
											</div>
											<div class="listing-day">
												<div class="day">Tuesday</div>
												<div class="time-items">
													<span class="time">07:00 AM - 09:00 PM</span>
												</div>
											</div>
											<div class="listing-day">
												<div class="day">Wednesday</div>
												<div class="time-items">
													<span class="time">07:00 AM - 09:00 PM</span>
												</div>
											</div>
											<div class="listing-day">
												<div class="day">Thursday</div>
												<div class="time-items">
													<span class="time">07:00 AM - 09:00 PM</span>
												</div>
											</div>
											<div class="listing-day">
												<div class="day">Friday</div>
												<div class="time-items">
													<span class="time">07:00 AM - 09:00 PM</span>
												</div>
											</div>
											<div class="listing-day">
												<div class="day">Saturday</div>
												<div class="time-items">
													<span class="time">07:00 AM - 09:00 PM</span>
												</div>
											</div>
											<div class="listing-day closed">
												<div class="day">Sunday</div>
												<div class="time-items">
													<span class="time"><span
															class="badge bg-danger-light">Closed</span></span>
												</div>
											</div>
										</div>
									</div>
								</div>
								<!-- /Business Hours Widget -->

							</div>
						</div>
					</div>
					<!-- /Business Hours Content -->

				</div>
			</div>
		</div>
		<!-- /Doctor Details Tab -->

	</div>
</div>
<!-- /Page Content -->

<!-- Footer -->
<footer class="footer">

	<!-- Footer Top -->
	<div class="footer-top">
		<div class="container-fluid">
			<div class="row">
				<div class="col-lg-3 col-md-6">

					<!-- Footer Widget -->
					<div class="footer-widget footer-about">
						<div class="footer-logo">
							<img src="assets/img/footer-logo.png" alt="logo">
						</div>
						<div class="footer-about-content">
							<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt
								ut labore et dolore magna aliqua. </p>
							<div class="social-icon">
								<ul>
									<li>
										<a href="#" target="_blank"><i class="fab fa-facebook-f"></i> </a>
									</li>
									<li>
										<a href="#" target="_blank"><i class="fab fa-twitter"></i> </a>
									</li>
									<li>
										<a href="#" target="_blank"><i class="fab fa-linkedin-in"></i></a>
									</li>
									<li>
										<a href="#" target="_blank"><i class="fab fa-instagram"></i></a>
									</li>
									<li>
										<a href="#" target="_blank"><i class="fab fa-dribbble"></i> </a>
									</li>
								</ul>
							</div>
						</div>
					</div>
					<!-- /Footer Widget -->

				</div>

				<div class="col-lg-3 col-md-6">

					<!-- Footer Widget -->
					<div class="footer-widget footer-menu">
						<h2 class="footer-title">For Patients</h2>
						<ul>
							<li><a href="search.html"><i class="fas fa-angle-double-right"></i> Search for Doctors</a>
							</li>
							<li><a href="login.html"><i class="fas fa-angle-double-right"></i> Login</a></li>
							<li><a href="register.html"><i class="fas fa-angle-double-right"></i> Register</a></li>
							<li><a href="booking.html"><i class="fas fa-angle-double-right"></i> Booking</a></li>
							<li><a href="patient-dashboard.html"><i class="fas fa-angle-double-right"></i> Patient
									Dashboard</a></li>
						</ul>
					</div>
					<!-- /Footer Widget -->

				</div>

				<div class="col-lg-3 col-md-6">

					<!-- Footer Widget -->
					<div class="footer-widget footer-menu">
						<h2 class="footer-title">For Doctors</h2>
						<ul>
							<li><a href="appointments.html"><i class="fas fa-angle-double-right"></i> Appointments</a>
							</li>
							<li><a href="chat.html"><i class="fas fa-angle-double-right"></i> Chat</a></li>
							<li><a href="login.html"><i class="fas fa-angle-double-right"></i> Login</a></li>
							<li><a href="doctor-register.html"><i class="fas fa-angle-double-right"></i> Register</a>
							</li>
							<li><a href="doctor-dashboard.html"><i class="fas fa-angle-double-right"></i> Doctor
									Dashboard</a></li>
						</ul>
					</div>
					<!-- /Footer Widget -->

				</div>
